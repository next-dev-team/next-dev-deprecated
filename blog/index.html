<!DOCTYPE html><html><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="shortcut icon" href="https://gw.alipayobjects.com/zos/bmw-prod/d3e3eb39-1cd7-4aa5-827c-877deced6b7e/lalxt4g3_w256_h256.png">
<link rel="stylesheet" href="/next-dev/umi.2aa52a83.css">
<title data-rh="true">Umi 4</title>
<meta data-rh="true" property="og:title" content="Umi 4"/><meta data-rh="true" name="description" content="大家好，Umi 4 经过几个月的开发，终于要和大家见面了。相比 Umi 2 到 3，3 到 4 的变化是巨大的，开发时间也更长，但我们尽量把对于开发者的影响降低到最小。按捺住激动的心情，在此先和大家分享下都有哪些变化。"/><meta data-rh="true" property="og:description" content="大家好，Umi 4 经过几个月的开发，终于要和大家见面了。相比 Umi 2 到 3，3 到 4 的变化是巨大的，开发时间也更长，但我们尽量把对于开发者的影响降低到最小。按捺住激动的心情，在此先和大家分享下都有哪些变化。"/>
</head>
<body>
<noscript><b>Enable JavaScript to run this app.</b></noscript><div id="root"><!--$?--><template id="B:0"></template><div></div><!--/$--></div><script>window.__UMI_LOADER_DATA__ = {}</script>
<script src="/next-dev/umi.dd8f8efd.js"></script>

</body></html><div hidden id="S:0"><!--$?--><template id="B:1"></template><div></div><!--/$--></div><script>function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("B:0","S:0")</script><div hidden id="S:1"><!--$?--><template id="B:2"></template><div></div><!--/$--><style data-token-hash="1tgnrr0" data-css-hash="85sof">:where(.css-1ij74fp)[class^="ant-float-btn"],:where(.css-1ij74fp)[class*=" ant-float-btn"]{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';font-size:14px;box-sizing:border-box;}:where(.css-1ij74fp)[class^="ant-float-btn"]::before,:where(.css-1ij74fp)[class*=" ant-float-btn"]::before,:where(.css-1ij74fp)[class^="ant-float-btn"]::after,:where(.css-1ij74fp)[class*=" ant-float-btn"]::after{box-sizing:border-box;}:where(.css-1ij74fp)[class^="ant-float-btn"] [class^="ant-float-btn"],:where(.css-1ij74fp)[class*=" ant-float-btn"] [class^="ant-float-btn"],:where(.css-1ij74fp)[class^="ant-float-btn"] [class*=" ant-float-btn"],:where(.css-1ij74fp)[class*=" ant-float-btn"] [class*=" ant-float-btn"]{box-sizing:border-box;}:where(.css-1ij74fp)[class^="ant-float-btn"] [class^="ant-float-btn"]::before,:where(.css-1ij74fp)[class*=" ant-float-btn"] [class^="ant-float-btn"]::before,:where(.css-1ij74fp)[class^="ant-float-btn"] [class*=" ant-float-btn"]::before,:where(.css-1ij74fp)[class*=" ant-float-btn"] [class*=" ant-float-btn"]::before,:where(.css-1ij74fp)[class^="ant-float-btn"] [class^="ant-float-btn"]::after,:where(.css-1ij74fp)[class*=" ant-float-btn"] [class^="ant-float-btn"]::after,:where(.css-1ij74fp)[class^="ant-float-btn"] [class*=" ant-float-btn"]::after,:where(.css-1ij74fp)[class*=" ant-float-btn"] [class*=" ant-float-btn"]::after{box-sizing:border-box;}:where(.css-1ij74fp).ant-float-btn-group{box-sizing:border-box;margin:0;padding:0;color:rgba(0, 0, 0, 0.88);font-size:14px;line-height:1.5714285714285714;list-style:none;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';z-index:99;display:block;border:none;position:fixed;width:40px;height:auto;box-shadow:none;min-height:40px;inset-inline-end:24px;inset-block-end:48px;border-radius:6px;}:where(.css-1ij74fp).ant-float-btn-group .ant-float-btn-group-wrap{z-index:-1;display:block;position:relative;margin-bottom:16px;}:where(.css-1ij74fp).ant-float-btn-group:where(.css-1ij74fp).ant-float-btn-group-rtl{direction:rtl;}:where(.css-1ij74fp).ant-float-btn-group .ant-float-btn{position:static;}:where(.css-1ij74fp).ant-float-btn-group-circle .ant-float-btn-circle:not(:last-child){margin-bottom:16px;}:where(.css-1ij74fp).ant-float-btn-group-circle .ant-float-btn-circle:not(:last-child) .ant-float-btn-body{width:40px;height:40px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-square{border-radius:0;padding:0;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-square:first-child{border-start-start-radius:6px;border-start-end-radius:6px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-square:last-child{border-end-start-radius:6px;border-end-end-radius:6px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-square:not(:last-child){border-bottom:1px solid rgba(5, 5, 5, 0.06);}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap{display:block;border-radius:6px;box-shadow:0 6px 16px 0 rgba(0, 0, 0, 0.08),0 3px 6px -4px rgba(0, 0, 0, 0.12),0 9px 28px 8px rgba(0, 0, 0, 0.05);overflow:hidden;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap .ant-float-btn-square{box-shadow:none;margin-top:0;border-radius:0;padding:4px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap .ant-float-btn-square:first-child{border-start-start-radius:6px;border-start-end-radius:6px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap .ant-float-btn-square:last-child{border-end-start-radius:6px;border-end-end-radius:6px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap .ant-float-btn-square:not(:last-child){border-bottom:1px solid rgba(5, 5, 5, 0.06);}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap .ant-float-btn-square .ant-float-btn-body{width:32px;height:32px;}:where(.css-1ij74fp).ant-float-btn-group-circle-shadow{box-shadow:none;}:where(.css-1ij74fp).ant-float-btn-group-square-shadow{box-shadow:0 6px 16px 0 rgba(0, 0, 0, 0.08),0 3px 6px -4px rgba(0, 0, 0, 0.12),0 9px 28px 8px rgba(0, 0, 0, 0.05);}:where(.css-1ij74fp).ant-float-btn-group-square-shadow .ant-float-btn-square{box-shadow:none;padding:4px;}:where(.css-1ij74fp).ant-float-btn-group-square-shadow .ant-float-btn-square .ant-float-btn-body{width:32px;height:32px;}:where(.css-1ij74fp).ant-float-btn{box-sizing:border-box;margin:0;padding:0;color:rgba(0, 0, 0, 0.88);font-size:14px;line-height:1.5714285714285714;list-style:none;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';border:none;position:fixed;cursor:pointer;overflow:hidden;z-index:99;display:block;justify-content:center;align-items:center;width:40px;height:40px;inset-inline-end:24px;inset-block-end:48px;box-shadow:0 6px 16px 0 rgba(0, 0, 0, 0.08),0 3px 6px -4px rgba(0, 0, 0, 0.12),0 9px 28px 8px rgba(0, 0, 0, 0.05);}:where(.css-1ij74fp).ant-float-btn-pure{position:relative;inset:auto;}:where(.css-1ij74fp).ant-float-btn:empty{display:none;}:where(.css-1ij74fp).ant-float-btn .ant-float-btn-body{width:40px;height:40px;display:flex;justify-content:center;align-items:center;transition:all 0.2s;}:where(.css-1ij74fp).ant-float-btn .ant-float-btn-body .ant-float-btn-content{overflow:hidden;text-align:center;min-height:40px;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:2px 4px;}:where(.css-1ij74fp).ant-float-btn .ant-float-btn-body .ant-float-btn-content .ant-float-btn-icon{text-align:center;margin:auto;width:18px;font-size:18px;line-height:1;}:where(.css-1ij74fp).ant-float-btn-circle{height:40px;border-radius:50%;}:where(.css-1ij74fp).ant-float-btn-circle .ant-float-btn-body{border-radius:50%;}:where(.css-1ij74fp).ant-float-btn-square{height:auto;min-height:40px;border-radius:6px;}:where(.css-1ij74fp).ant-float-btn-square .ant-float-btn-body{height:auto;border-radius:4px;}:where(.css-1ij74fp).ant-float-btn-default{background-color:#ffffff;transition:background-color 0.2s;}:where(.css-1ij74fp).ant-float-btn-default .ant-float-btn-body{background-color:#ffffff;transition:background-color 0.2s;}:where(.css-1ij74fp).ant-float-btn-default .ant-float-btn-body:hover{background-color:rgba(0, 0, 0, 0.06);}:where(.css-1ij74fp).ant-float-btn-default .ant-float-btn-body .ant-float-btn-content .ant-float-btn-icon{color:rgba(0, 0, 0, 0.88);}:where(.css-1ij74fp).ant-float-btn-default .ant-float-btn-body .ant-float-btn-content .ant-float-btn-description{display:flex;align-items:center;line-height:16px;color:rgba(0, 0, 0, 0.88);font-size:12px;}:where(.css-1ij74fp).ant-float-btn-primary{background-color:#1677ff;}:where(.css-1ij74fp).ant-float-btn-primary .ant-float-btn-body{background-color:#1677ff;transition:background-color 0.2s;}:where(.css-1ij74fp).ant-float-btn-primary .ant-float-btn-body:hover{background-color:#4096ff;}:where(.css-1ij74fp).ant-float-btn-primary .ant-float-btn-body .ant-float-btn-content .ant-float-btn-icon{color:#fff;}:where(.css-1ij74fp).ant-float-btn-primary .ant-float-btn-body .ant-float-btn-content .ant-float-btn-description{display:flex;align-items:center;line-height:16px;color:#fff;font-size:12px;}:where(.css-1ij74fp).ant-fade-enter,:where(.css-1ij74fp).ant-fade-appear{animation-duration:0.2s;animation-fill-mode:both;animation-play-state:paused;}:where(.css-1ij74fp).ant-fade-leave{animation-duration:0.2s;animation-fill-mode:both;animation-play-state:paused;}:where(.css-1ij74fp).ant-fade-enter.ant-fade-enter-active,:where(.css-1ij74fp).ant-fade-appear.ant-fade-appear-active{animation-name:css-1ij74fp-antFadeIn;animation-play-state:running;}:where(.css-1ij74fp).ant-fade-leave.ant-fade-leave-active{animation-name:css-1ij74fp-antFadeOut;animation-play-state:running;pointer-events:none;}:where(.css-1ij74fp).ant-fade-enter,:where(.css-1ij74fp).ant-fade-appear{opacity:0;animation-timing-function:linear;}:where(.css-1ij74fp).ant-fade-leave{animation-timing-function:linear;}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-enter,:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-appear{animation-duration:0.3s;animation-fill-mode:both;animation-play-state:paused;}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-leave{animation-duration:0.3s;animation-fill-mode:both;animation-play-state:paused;}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-enter.ant-float-btn-group-wrap-enter-active,:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-appear.ant-float-btn-group-wrap-appear-active{animation-name:css-1ij74fp-antFloatButtonMoveDownIn;animation-play-state:running;}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-leave.ant-float-btn-group-wrap-leave-active{animation-name:css-1ij74fp-antFloatButtonMoveDownOut;animation-play-state:running;pointer-events:none;}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-enter,:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-appear{opacity:0;animation-timing-function:cubic-bezier(0.78, 0.14, 0.15, 0.86);}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-leave{animation-timing-function:cubic-bezier(0.78, 0.14, 0.15, 0.86);}</style><div class="ant-float-btn-group css-1ij74fp ant-float-btn-group-circle"><style data-token-hash="1tgnrr0" data-css-hash="85sof">:where(.css-1ij74fp)[class^="ant-float-btn"],:where(.css-1ij74fp)[class*=" ant-float-btn"]{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';font-size:14px;box-sizing:border-box;}:where(.css-1ij74fp)[class^="ant-float-btn"]::before,:where(.css-1ij74fp)[class*=" ant-float-btn"]::before,:where(.css-1ij74fp)[class^="ant-float-btn"]::after,:where(.css-1ij74fp)[class*=" ant-float-btn"]::after{box-sizing:border-box;}:where(.css-1ij74fp)[class^="ant-float-btn"] [class^="ant-float-btn"],:where(.css-1ij74fp)[class*=" ant-float-btn"] [class^="ant-float-btn"],:where(.css-1ij74fp)[class^="ant-float-btn"] [class*=" ant-float-btn"],:where(.css-1ij74fp)[class*=" ant-float-btn"] [class*=" ant-float-btn"]{box-sizing:border-box;}:where(.css-1ij74fp)[class^="ant-float-btn"] [class^="ant-float-btn"]::before,:where(.css-1ij74fp)[class*=" ant-float-btn"] [class^="ant-float-btn"]::before,:where(.css-1ij74fp)[class^="ant-float-btn"] [class*=" ant-float-btn"]::before,:where(.css-1ij74fp)[class*=" ant-float-btn"] [class*=" ant-float-btn"]::before,:where(.css-1ij74fp)[class^="ant-float-btn"] [class^="ant-float-btn"]::after,:where(.css-1ij74fp)[class*=" ant-float-btn"] [class^="ant-float-btn"]::after,:where(.css-1ij74fp)[class^="ant-float-btn"] [class*=" ant-float-btn"]::after,:where(.css-1ij74fp)[class*=" ant-float-btn"] [class*=" ant-float-btn"]::after{box-sizing:border-box;}:where(.css-1ij74fp).ant-float-btn-group{box-sizing:border-box;margin:0;padding:0;color:rgba(0, 0, 0, 0.88);font-size:14px;line-height:1.5714285714285714;list-style:none;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';z-index:99;display:block;border:none;position:fixed;width:40px;height:auto;box-shadow:none;min-height:40px;inset-inline-end:24px;inset-block-end:48px;border-radius:6px;}:where(.css-1ij74fp).ant-float-btn-group .ant-float-btn-group-wrap{z-index:-1;display:block;position:relative;margin-bottom:16px;}:where(.css-1ij74fp).ant-float-btn-group:where(.css-1ij74fp).ant-float-btn-group-rtl{direction:rtl;}:where(.css-1ij74fp).ant-float-btn-group .ant-float-btn{position:static;}:where(.css-1ij74fp).ant-float-btn-group-circle .ant-float-btn-circle:not(:last-child){margin-bottom:16px;}:where(.css-1ij74fp).ant-float-btn-group-circle .ant-float-btn-circle:not(:last-child) .ant-float-btn-body{width:40px;height:40px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-square{border-radius:0;padding:0;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-square:first-child{border-start-start-radius:6px;border-start-end-radius:6px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-square:last-child{border-end-start-radius:6px;border-end-end-radius:6px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-square:not(:last-child){border-bottom:1px solid rgba(5, 5, 5, 0.06);}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap{display:block;border-radius:6px;box-shadow:0 6px 16px 0 rgba(0, 0, 0, 0.08),0 3px 6px -4px rgba(0, 0, 0, 0.12),0 9px 28px 8px rgba(0, 0, 0, 0.05);overflow:hidden;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap .ant-float-btn-square{box-shadow:none;margin-top:0;border-radius:0;padding:4px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap .ant-float-btn-square:first-child{border-start-start-radius:6px;border-start-end-radius:6px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap .ant-float-btn-square:last-child{border-end-start-radius:6px;border-end-end-radius:6px;}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap .ant-float-btn-square:not(:last-child){border-bottom:1px solid rgba(5, 5, 5, 0.06);}:where(.css-1ij74fp).ant-float-btn-group-square .ant-float-btn-group-wrap .ant-float-btn-square .ant-float-btn-body{width:32px;height:32px;}:where(.css-1ij74fp).ant-float-btn-group-circle-shadow{box-shadow:none;}:where(.css-1ij74fp).ant-float-btn-group-square-shadow{box-shadow:0 6px 16px 0 rgba(0, 0, 0, 0.08),0 3px 6px -4px rgba(0, 0, 0, 0.12),0 9px 28px 8px rgba(0, 0, 0, 0.05);}:where(.css-1ij74fp).ant-float-btn-group-square-shadow .ant-float-btn-square{box-shadow:none;padding:4px;}:where(.css-1ij74fp).ant-float-btn-group-square-shadow .ant-float-btn-square .ant-float-btn-body{width:32px;height:32px;}:where(.css-1ij74fp).ant-float-btn{box-sizing:border-box;margin:0;padding:0;color:rgba(0, 0, 0, 0.88);font-size:14px;line-height:1.5714285714285714;list-style:none;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';border:none;position:fixed;cursor:pointer;overflow:hidden;z-index:99;display:block;justify-content:center;align-items:center;width:40px;height:40px;inset-inline-end:24px;inset-block-end:48px;box-shadow:0 6px 16px 0 rgba(0, 0, 0, 0.08),0 3px 6px -4px rgba(0, 0, 0, 0.12),0 9px 28px 8px rgba(0, 0, 0, 0.05);}:where(.css-1ij74fp).ant-float-btn-pure{position:relative;inset:auto;}:where(.css-1ij74fp).ant-float-btn:empty{display:none;}:where(.css-1ij74fp).ant-float-btn .ant-float-btn-body{width:40px;height:40px;display:flex;justify-content:center;align-items:center;transition:all 0.2s;}:where(.css-1ij74fp).ant-float-btn .ant-float-btn-body .ant-float-btn-content{overflow:hidden;text-align:center;min-height:40px;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:2px 4px;}:where(.css-1ij74fp).ant-float-btn .ant-float-btn-body .ant-float-btn-content .ant-float-btn-icon{text-align:center;margin:auto;width:18px;font-size:18px;line-height:1;}:where(.css-1ij74fp).ant-float-btn-circle{height:40px;border-radius:50%;}:where(.css-1ij74fp).ant-float-btn-circle .ant-float-btn-body{border-radius:50%;}:where(.css-1ij74fp).ant-float-btn-square{height:auto;min-height:40px;border-radius:6px;}:where(.css-1ij74fp).ant-float-btn-square .ant-float-btn-body{height:auto;border-radius:4px;}:where(.css-1ij74fp).ant-float-btn-default{background-color:#ffffff;transition:background-color 0.2s;}:where(.css-1ij74fp).ant-float-btn-default .ant-float-btn-body{background-color:#ffffff;transition:background-color 0.2s;}:where(.css-1ij74fp).ant-float-btn-default .ant-float-btn-body:hover{background-color:rgba(0, 0, 0, 0.06);}:where(.css-1ij74fp).ant-float-btn-default .ant-float-btn-body .ant-float-btn-content .ant-float-btn-icon{color:rgba(0, 0, 0, 0.88);}:where(.css-1ij74fp).ant-float-btn-default .ant-float-btn-body .ant-float-btn-content .ant-float-btn-description{display:flex;align-items:center;line-height:16px;color:rgba(0, 0, 0, 0.88);font-size:12px;}:where(.css-1ij74fp).ant-float-btn-primary{background-color:#1677ff;}:where(.css-1ij74fp).ant-float-btn-primary .ant-float-btn-body{background-color:#1677ff;transition:background-color 0.2s;}:where(.css-1ij74fp).ant-float-btn-primary .ant-float-btn-body:hover{background-color:#4096ff;}:where(.css-1ij74fp).ant-float-btn-primary .ant-float-btn-body .ant-float-btn-content .ant-float-btn-icon{color:#fff;}:where(.css-1ij74fp).ant-float-btn-primary .ant-float-btn-body .ant-float-btn-content .ant-float-btn-description{display:flex;align-items:center;line-height:16px;color:#fff;font-size:12px;}:where(.css-1ij74fp).ant-fade-enter,:where(.css-1ij74fp).ant-fade-appear{animation-duration:0.2s;animation-fill-mode:both;animation-play-state:paused;}:where(.css-1ij74fp).ant-fade-leave{animation-duration:0.2s;animation-fill-mode:both;animation-play-state:paused;}:where(.css-1ij74fp).ant-fade-enter.ant-fade-enter-active,:where(.css-1ij74fp).ant-fade-appear.ant-fade-appear-active{animation-name:css-1ij74fp-antFadeIn;animation-play-state:running;}:where(.css-1ij74fp).ant-fade-leave.ant-fade-leave-active{animation-name:css-1ij74fp-antFadeOut;animation-play-state:running;pointer-events:none;}:where(.css-1ij74fp).ant-fade-enter,:where(.css-1ij74fp).ant-fade-appear{opacity:0;animation-timing-function:linear;}:where(.css-1ij74fp).ant-fade-leave{animation-timing-function:linear;}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-enter,:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-appear{animation-duration:0.3s;animation-fill-mode:both;animation-play-state:paused;}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-leave{animation-duration:0.3s;animation-fill-mode:both;animation-play-state:paused;}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-enter.ant-float-btn-group-wrap-enter-active,:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-appear.ant-float-btn-group-wrap-appear-active{animation-name:css-1ij74fp-antFloatButtonMoveDownIn;animation-play-state:running;}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-leave.ant-float-btn-group-wrap-leave-active{animation-name:css-1ij74fp-antFloatButtonMoveDownOut;animation-play-state:running;pointer-events:none;}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-enter,:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-appear{opacity:0;animation-timing-function:cubic-bezier(0.78, 0.14, 0.15, 0.86);}:where(.css-1ij74fp).ant-float-btn-group-wrap.ant-float-btn-group-wrap-leave{animation-timing-function:cubic-bezier(0.78, 0.14, 0.15, 0.86);}</style><button class="css-1ij74fp ant-float-btn ant-float-btn-default ant-float-btn-circle" type="button"><div class="ant-float-btn-body"><div class="ant-float-btn-content"><div class="ant-float-btn-icon"><span role="img" class="anticon"><svg width="21" height="21" viewBox="0 0 21 21" fill="currentColor"><g fill-rule="evenodd"><g fill-rule="nonzero"><path d="M7.02 3.635l12.518 12.518a1.863 1.863 0 010 2.635l-1.317 1.318a1.863 1.863 0 01-2.635 0L3.068 7.588A2.795 2.795 0 117.02 3.635zm2.09 14.428a.932.932 0 110 1.864.932.932 0 010-1.864zm-.043-9.747L7.75 9.635l9.154 9.153 1.318-1.317-9.154-9.155zM3.52 12.473c.514 0 .931.417.931.931v.932h.932a.932.932 0 110 1.864h-.932v.931a.932.932 0 01-1.863 0l-.001-.931h-.93a.932.932 0 010-1.864h.93v-.932c0-.514.418-.931.933-.931zm15.374-3.727a1.398 1.398 0 110 2.795 1.398 1.398 0 010-2.795zM4.385 4.953a.932.932 0 000 1.317l2.046 2.047L7.75 7 5.703 4.953a.932.932 0 00-1.318 0zM14.701.36a.932.932 0 01.931.932v.931h.932a.932.932 0 010 1.864h-.933l.001.932a.932.932 0 11-1.863 0l-.001-.932h-.93a.932.932 0 110-1.864h.93v-.931a.932.932 0 01.933-.932z"></path></g></g></svg></span></div></div></div></button></div></div><script>$RC("B:1","S:1")</script><div hidden id="S:2"><div class="dumi-default-doc-layout"><div class="dumi-default-header"><div class="dumi-default-header-content"><section class="dumi-default-header-left"><a class="dumi-default-logo" href="/"><img src="https://gw.alipayobjects.com/zos/bmw-prod/d3e3eb39-1cd7-4aa5-827c-877deced6b7e/lalxt4g3_w256_h256.png" alt="Next Dev"/>Next Dev</a></section><section class="dumi-default-header-right"><ul class="dumi-default-navbar"><li><a class="active" href="/blog">Blog</a></li><li><a href="/tw-uis">Tw UI</a></li><li><a href="/uis">Antd UI</a></li><li><a href="/configs">Configuration</a></li><li><a href="/libs/changelog">Utilities</a></li><li><a href="/lints">Lint</a></li></ul><div class="dumi-default-header-right-aside"><div class="dumi-default-search-bar"><svg viewBox="64 64 896 896" class="dumi-default-search-bar-svg"><path d="M909.6 854.5 649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0 0 11.6 0l43.6-43.5a8.2 8.2 0 0 0 0-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"></path></svg><input class="dumi-default-search-bar-input" placeholder="Type keywords..."/><span class="dumi-default-search-shortcut">⌘<!-- --> K</span></div><a class="dumi-default-lang-switch" href="/blog-km">ខ្មែរ</a></div></section><button type="button" class="dumi-default-header-menu-btn"><svg viewBox="64 64 896 896"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></button></div></div><div class="dumi-default-doc-layout-mobile-bar"><button type="button" class="dumi-default-sidebar-btn"><svg viewBox="64 64 896 896"><path d="M120 230h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm0 424h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm784 140H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-424H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"></path></svg>Sidebar</button></div><main><div class="dumi-default-sidebar"><dl class="dumi-default-sidebar-group"><dt>Umi</dt><dd><a title="Umi 4" aria-current="page" class="active" href="/blog">Umi 4</a></dd></dl></div><div class="dumi-default-content"><!--$?--><template id="B:3"></template><div></div><!--/$--><div class="dumi-default-footer">Open-source MIT Licensed | Copyright © 2019-2022<br /> Powered by Next Dev</div></div><div class="dumi-default-doc-layout-toc-wrapper"><h4>TABLE OF CONTENTS</h4></div></main></div></div><script>$RC("B:2","S:2")</script><div hidden id="S:3"><div class="markdown"><h1 id="umi-4"><a aria-hidden="true" tabindex="-1" href="#umi-4"><span class="icon icon-link"></span></a>Umi 4</h1><p>大家好，Umi 4 经过几个月的开发，终于要和大家见面了。相比 Umi 2 到 3，3 到 4 的变化是巨大的，开发时间也更长，但我们尽量把对于开发者的影响降低到最小。按捺住激动的心情，在此先和大家分享下都有哪些变化。</p><p>🎉 新官网和文档<br/> 🚀 MFSU V3 &amp; 默认开启<br/> 🎭 双构建引擎和 ESMi<br/> 🕸 Webpack 5<br/> ⛹🏾‍♂️ React Router 6 &amp; 新路由<br/> 🐹 最佳实践迭代<br/> 🛡️ 依赖预打包<br/> 🤺 Umi Max<br/> 🐛 Low Import 研发模式<br/> ⚠️ 强约束功能集成<br/> 🎈 Import All From Umi 迭代<br/> 🍀 srcTranspiler 和 depTranspiler<br/> 🌼 jsMinifier 和 cssMinifier<br/> 🌸 应用元数据<br/> ❄️ 微生成器<br/> 🧪 贴心小改进<br/></p><p>
  <span color:="" fontweight:="">新官网和文档。</span>
  下图是新官网的首页，包括重新梳理的文档、信息结构、以及新写的文档插件。目前包含基础的配置、API、升级和快速上手等基础文档，剩余文档还在紧张编写中。有个变化是之前插件的文档集成到
  Umi 官网中，成为 Umi Max 的一部分，之后无需跳转。
</p><p><img src="https://img.alicdn.com/imgextra/i1/O1CN014dDq4L1Zc3guRwcse_!!6000000003214-2-tps-1600-941.png" alt=""/></p><p>
  <span color:="" fontweight:="">MFSU V3 &amp; 默认开启。</span>
  MFSU 更新了他的第三个大版本，如果你有用 Umi 3 内置的 MFSU 并遇到问题，建议重新尝试，这个版本有很多改进，解决基本所有之前可能会遇到的诡异问题，并且编译速度和页面打开速度都更快。昨天我还有写一篇
  [《比 Vite 更快的 MFSU》](https://mp.weixin.qq.com/s?__biz=MjM5NDgyODI4MQ==&amp;mid=2247484624&amp;idx=1&amp;sn=2addfa8cc2511fbea91faf831195788f)。基于此，我们自信地把这个功能  在
  Umi 4 中默认开启。还有值得一提的是，MFSU 可脱离 Umi 运行。
</p><p><img src="https://img.alicdn.com/imgextra/i2/O1CN01Znj8HD1mCwz72voXv_!!6000000004919-2-tps-1600-807.png" alt=""/></p><p>
  <span color:="" fontweight:="">双构建引擎和 ESMi。</span>
  Umi 4 提供 Vite 和 Webpack 两种构建模式供开发者选择，并尽可能保证他们之间功能的一致性，可能有些同学会喜欢
  dev 用 vite，build 用 webpack 这样的组合。同时基于 Vite 模式实现了 ESMi 的 Client
  端，ESMi 依赖服务端，在外网还无法使用。
</p><p>
  <span color:="" fontweight:="">Webpack 5。</span>Umi 4
  默认使用 webpack 5 并开启物理缓存。
</p><p>
  <span color:="" fontweight:="">
    React Router 6 &amp; 新路由。
  </span>
  Umi 4 的路由基于 React Router 6 实现，个人非常喜欢这个版本，因为 Remix 的原因，React
  Router 6 从设计上考虑了配置式路由的场景，让我得以删除大量 Umi 3 中关于路由渲染的代码。同时基于此，设计了新的路由结构，方便扩展和在未来处理路由的约定式请求。
</p><p>
  <span color:="" fontweight:="">最佳实践迭代。</span>
  针对之前 umijs/plugins 仓库中的插件进行了重写、升级，并整合到主仓库。这么做是为了更好的顶层设计，让官方插件之间的风格更一致。
</p><p>
  <span color:="" fontweight:="">​​依赖预打包。</span>
  由于服务企业内部，安全和稳定是其中很重要点，加上最近 colors 和 faker.js 闹得社区沸沸扬扬，谁都不希望睡一觉醒来，自己负责的业务挂了，还背个故障。Umi
  4 接着 Umi 3 继续做依赖预打包的事，并且更彻底，不仅是 node 侧的依赖，部分运行时的依赖也会做锁定，比如
  core-js 和 @babel/runtime。
</p><p><img src="https://img.alicdn.com/imgextra/i1/O1CN01h44iJg1T09DNuYOlm_!!6000000002319-2-tps-1600-758.png" alt=""/></p><p>
  <span color:="" fontweight:="">Umi Max。</span>Umi Max
    是内部 Bigfish
  框架的对外版本，解我们自己的问题，同时也给社区另一个集中化框架的选择。
</p><p>
  <span color:="" fontweight:="">
    Low Import 研发模式。
  </span>
  这是 Umi 4 的试验性功能之一，目前已开发完成，解的问题是让开发者少些或不写 import
  语句。项目中大量的 import 其实都可以通过工程化的方式自动处理。Umi 4 里通过 lowImport:{&#x27; &#x27;}
  {} 开启，然后就可以无 import 直接用路由相关的 Link、useLocation 等，数据流相关的
  connect、useModel，antd 组件 Button、Calendar 等，以及其他更多。
</p><p><img src="https://img.alicdn.com/imgextra/i4/O1CN0142Vcpt25kMZqjmioe_!!6000000007564-2-tps-1600-631.png" alt=""/></p><p>
  <span color:="" fontweight:="">强约束功能集成。</span>Umi
  4 提供 API 让强约束和代码校验变得非常容易。API 包括
  api.onCheck、api.onCheckConfig、api.onCheckPkgJSON 和
  api.onCheckCode，顾名思义，非常好理解他们分别是干嘛的，可以分别对依赖类、代码类和配置类的内容做校验和卡点，适用于团队。
</p><p>
  <span color:="" fontweight:="">
    Import All From Umi 迭代。
  </span>
  这是两年前 Umi 3 加的功能，最近发现 Remix、prisma、vitekit 等框架和工具都有类似实现。这种方式有好有坏。好处是通过
  umi 将大量依赖管理起来，用户无需手动安装。坏处是更黑盒，同时有点 Hack。Umi 4 不能解其黑盒问题，但解了
  Hack 问题，让实现无副作用，可以和 Vite、MFSU 等方案无缝结合。
</p><p>
  <span color:="" fontweight:="">
    srcTranspiler 和 depTranspiler。
  </span>
  提供针对源码编译和依赖编译更多选择。源码编译可选 babel、swc 和 esbuild，目前没有银弹，合适场景做合适的选择。比如
  swc 由于不支持 top level await，和 mfsu 会有些冲突，但他适用于 build，因为有补丁可以兼容到
  es7；比如 esbuild 适用于 dev，因 为快。数据方面以 ant-design-pro 项目为例，源码编译用
  esbuild 相比 babel 在 M1 2020 无缓存情况下会快 3s。
</p><p>
  <span color:="" fontweight:="">
    jsMinifier 和 cssMinifier。
  </span>
  js 压缩和 css 压缩 Umi 4 默认都用的 esbuild，因为快。同时也提供更多选择，js 压缩还支持
  swc、terser 和 uglifyJs，css 压缩还支持 cssnano。
</p><p>
  <span color:="" fontweight:="">应用元数据。</span>Umi 4
  有通过 api.appData
  收集各种项目数据，从配置、路由、package.json、tsconfig.json、npmClient
  到数据流、国际化、antd 用了哪个版本、react 和 react-dom
  的版本等，应有尽有，这对于插件开发者会非常实用，也适用于有统计需求的场景。
</p><p>
  <span color:="" fontweight:="">微生成器。</span>没错，就是
  modern.js 的微生成器，这功能从 modern.js
  里学习了不少，名字就不改了。举个例子，比如 prettier
  功能，可能不是每个项目都需要，就比较适用于微生成器，按需启用、添加配置、安装依赖。
</p><p>
  <span color:="" fontweight:="">贴心小改进。</span>
  还有不少贴心小改进，举两个例子。1 是项目中新增 plugin.ts，会默认作为插件添加，方便项目进行一些插件级的扩展；2
  是调试问题时通常需要修改编译后的代码看看有没有改对，你把 umi.js 下下来存到项目根目录，umi
  会优先使用这份代码。
</p><h2 id="以上是-umi-4-目前的新功能"><a aria-hidden="true" tabindex="-1" href="#以上是-umi-4-目前的新功能"><span class="icon icon-link"></span></a>以上是 Umi 4 目前的新功能。</h2><p>除此之外，还有一些计划在正式版发布之前做的事情。包括 &lt;span style={{color:&#x27;red&#x27;}}&gt;api route、umi server and adapter、route loader、稳定的 lint、更多命令、组件研发 father 4、文档工具 dumi 2 等，会在之后的 RC 版本中与大家见面。</p><p>欢迎大家尝鲜 Umi 4，官方文档有准备 ant-design-pro 从 Umi 3 到 4 的升级文档。同时 RC 阶段，还准备了一个&lt;span style={{color:&#x27;red&#x27;,fontWeight:&#x27;bold&#x27;}}&gt;手把手升级的微信交流群，欢迎 Umi 4 的先行者们加入，祝大家升级顺利，也提前祝大家新年快乐 🧨，🐯 年吉祥。</p><p></p><p><img src="https://img.alicdn.com/imgextra/i4/O1CN01QmMTeR1jd6l2cwHQh_!!6000000004570-0-tps-1170-1500.jpg" width="300"/></p><p></p></div></div><script>$RC("B:3","S:3")</script>